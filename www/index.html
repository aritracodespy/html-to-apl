<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Note App</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    body.light {
      background: #f4f4f4;
      color: #000;
    }

    body.dark {
      background: #121212;
      color: #fff;
    }

    header {
      background: #333;
      color: white;
      padding: 10px 20px;
      text-align: center;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      margin: 0;
      font-size: 24px;
    }

    #theme-toggle {
      padding: 6px 12px;
      font-size: 14px;
      cursor: pointer;
    }

    #main-section, #edit-section {
      display: none;
      padding: 20px;
    }

    .note-item {
      background: white;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 5px;
      color: black;
    }

    body.dark .note-item {
      background: #1e1e1e;
      color: white;
      border: 1px solid #444;
    }

    .note-item button {
      margin-left: 10px;
    }

    #note-list {
      margin-top: 20px;
    }

    #edit-section {
      width: 85vw;
    }

    #edit-section input,
    #edit-section textarea {
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      font-size: 16px;
      background: inherit;
      color: inherit;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    body.dark #edit-section input,
    body.dark #edit-section textarea {
      background: #222;
      border-color: #555;
      color: #fff;
    }

    #edit-section textarea {
      height: 60vh;
    }

    .buttons {
      display: flex;
      justify-content: space-around;
    }

    .buttons button {
      padding: 10px;
      font-size: 16px;
      width: 30vw;
    }

    .title-box {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .title-box strong {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      cursor: pointer;
    }

    .btn-box {
      display: flex;
      flex-shrink: 0;
      gap: 5px;
      white-space: nowrap;
    }

    .note-content {
      margin: 10px;
      padding: 10px;
      white-space: pre-wrap;
      border: 1px solid black;
    }

    body.dark .note-content {
      border-color: #666;
      background: #2a2a2a;
      color: #fff;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>Note App</h1>
    <button id="theme-toggle" onclick="toggleTheme()">🌙 Theme</button>
  </header>

  <section id="main-section">
    <div class="buttons">
      <button onclick="showEditSection()">+ Add Note</button>
    </div>
    <div id="note-list"></div>
  </section>

  <section id="edit-section">
    <input type="text" id="note-title" placeholder="Title"/>
    <textarea id="note-body" placeholder="Write your note here..."></textarea>
    <div class="buttons">
      <button onclick="saveNote()">Save</button>
      <button onclick="showMainSection()">Cancel</button>
    </div>
  </section>

  <script>
    let currentTitle = null;

    // THEME HANDLING
    function applyTheme(theme) {
      document.body.className = theme;
      localStorage.setItem("theme", theme);
      document.getElementById("theme-toggle").textContent = theme === "dark" ? "☀️ Light" : "🌙 Dark";
    }

    function toggleTheme() {
      const newTheme = document.body.className === "dark" ? "light" : "dark";
      applyTheme(newTheme);
    }

    // Apply stored theme or default to light
    window.onload = () => {
      const storedTheme = localStorage.getItem("theme") || "light";
      applyTheme(storedTheme);
      showMainSection();
    };

    // NOTES APP FUNCTIONS
    function getNotes() {
      return JSON.parse(localStorage.getItem("notes")) || {};
    }

    function setNotes(notes) {
      localStorage.setItem("notes", JSON.stringify(notes));
    }

    function showMainSection() {
      document.getElementById("edit-section").style.display = "none";
      document.getElementById("main-section").style.display = "block";
      loadNotes();
    }

    function showEditSection(title = "") {
      document.getElementById("main-section").style.display = "none";
      document.getElementById("edit-section").style.display = "block";
      currentTitle = title;
      if (title) {
        const notes = getNotes();
        document.getElementById("note-title").value = title;
        document.getElementById("note-body").value = notes[title];
      } else {
        document.getElementById("note-title").value = "";
        document.getElementById("note-body").value = "";
      }
    }

    function saveNote() {
      const title = document.getElementById("note-title").value.trim();
      const body = document.getElementById("note-body").value.trim();
      if (!title) {
        alert("Title cannot be empty!");
        return;
      }
      let notes = getNotes();
      if (currentTitle && currentTitle !== title) {
        delete notes[currentTitle];
      }
      notes[title] = body;
      setNotes(notes);
      showMainSection();
    }

    function deleteNote(title) {
      const notes = getNotes();
      delete notes[title];
      setNotes(notes);
      loadNotes();
    }

    function loadNotes() {
      const noteList = document.getElementById("note-list");
      noteList.innerHTML = "";

      const notes = getNotes();
      for (let title in notes) {
        const noteDiv = document.createElement("div");
        noteDiv.className = "note-item";

        const titleEl = document.createElement("strong");
        titleEl.textContent = title;
        titleEl.style.cursor = "pointer";
        titleEl.onclick = () => {
          contentDiv.classList.toggle("hidden");
        };

        const titleBoxEl = document.createElement("div");
        titleBoxEl.className = "title-box";

        const btnBoxEl = document.createElement("div");
        btnBoxEl.className = "btn-box";

        const contentDiv = document.createElement("div");
        contentDiv.className = "note-content hidden";
        contentDiv.textContent = notes[title];

        // Copy button
        const copyBtn = document.createElement("button");
        copyBtn.textContent = "Copy";
        copyBtn.onclick = () => {
          navigator.clipboard.writeText(notes[title])
            .then(() => alert("Note copied to clipboard!"))
            .catch(() => alert("Failed to copy note."));
        };

        // Edit button
        const editBtn = document.createElement("button");
        editBtn.textContent = "Edit";
        editBtn.onclick = () => showEditSection(title);

        // Delete button
        const delBtn = document.createElement("button");
        delBtn.textContent = "Delete";
        delBtn.onclick = () => {
          if (confirm("Delete this note?")) {
            deleteNote(title);
          }
        };

        titleBoxEl.appendChild(titleEl);
        btnBoxEl.appendChild(copyBtn);
        btnBoxEl.appendChild(editBtn);
        btnBoxEl.appendChild(delBtn);
        titleBoxEl.appendChild(btnBoxEl);

        noteDiv.appendChild(titleBoxEl);
        noteDiv.appendChild(contentDiv);
        noteList.appendChild(noteDiv);
      }
    }
  </script>
</body>
</html>
